import os
import base64
import zlib
import bz2

exec(base64.b64decode("aW1wb3J0IHRpbWUNCmltcG9ydCB1cmxsaWINCmltcG9ydCBzeXMNCmltcG9ydCBvcw0KDQpvcy5zeXN0ZW0oJ2NsZWFyJykNCg0KYmFyID0gIlwwMzNbMTszMzs0MG1cbl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cbiINCg0KbmFtZSA9ICIiIlwwMzNbMTszMjs0MG0NCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fDQpcMDMzWzE7MzY7NDBtICAgICAgX18gIF9fICAgICAgICAgICAgICAgXyAgICAgIF9fX18gICAgICAgIF8gICBfDQpcMDMzWzE7MzQ7NDBtICAgICB8ICBcLyAgfCBfX18gIF9fIF8gICAvIFwgICAgfCAgXyBcIF8gICBffCBcIHwgfA0KXDAzM1sxOzM2OzQwbSAgICAgfCB8XC98IHwvIF8gXC8gX2AgfCAvIE8gXCAgIHwgfF8pIHwgfCB8IHwgIFx8IHwNClwwMzNbMTszNDs0MG0gICAgIHwgfCAgfCB8ICBfXy8gKF98IHwvIF9fXyBcICB8ICBfIDx8IHxffCB8IHxcICB8DQpcMDMzWzE7MzY7NDBtICAgICB8X3wgIHxffFxfX198XF9fLCAvXy8gICBcX1wgfF98IFxfXCBcX19fL3xffCBcX3wNClwwMzNbMTszNDs0MG0gICAgICAgICAgICAgICAgICB8X19fLw0KDQpcMDMzWzE7MzU7NDBtICAgICAgICAgICAgICBbK10gVG9vbCBCeSBFUlJPUiBLSUxMRVINClwwMzNbMTszMjs0MG1fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KIiIiDQpwcmludChuYW1lLCAiIikNCg0KDQp0cnk6DQogICAgZiA9IG9wZW4oImF1dGgudHh0IiwgInIiKQ0KICAgIGF1dGggPSBmLnJlYWQoKQ0KICAgIGYuY2xvc2UNCmV4Y2VwdDoNCiAgICB3ciA9IHN0cihpbnB1dCgiXDAzM1sxOzA7NDBtUGFzdGUgWW91ciBBdXRoIGhlcmUgOi0gIikpDQogICAgZiA9IG9wZW4oImF1dGgudHh0IiwgInciKQ0KICAgIGYud3JpdGUod3IpDQogICAgZi5jbG9zZQ0KICAgIGYgPSBvcGVuKCJhdXRoLnR4dCIsICJyIikNCiAgICBhdXRoID0gZi5yZWFkKCkNCiAgICBmLmNsb3NlDQoNCnRyeToNCiAgICBmID0gb3BlbigidXJsLnR4dCIsICJyIikNCiAgICBmID0gb3BlbigidXJsLnR4dCIsICJyIikNCiAgICB1cmwxID0gZi5yZWFkKCkNCiAgICBmLmNsb3NlDQpleGNlcHQ6DQogICAgd3IgPSBzdHIoaW5wdXQoIlBhc3RlIFlvdXIgVVJMIGhlcmUgOi0gIikpDQogICAgZiA9IG9wZW4oInVybC50eHQiLCAidyIpDQogICAgZi53cml0ZSh3cikNCiAgICBmLmNsb3NlDQogICAgZiA9IG9wZW4oInVybC50eHQiLCAiciIpDQogICAgdXJsMSA9IGYucmVhZCgpDQogICAgZi5jbG9zZQ0KDQp0cnk6DQogICAgaW1wb3J0IHJlcXVlc3RzDQoNCg0KZXhjZXB0IEltcG9ydEVycm9yOg0KICAgIHByaW50KCclcyBSZXF1ZXN0cyBpc25cJ3QgaW5zdGFsbGVkLCBpbnN0YWxsaW5nIG5vdy4nKQ0KICAgIG9zLnN5c3RlbSgncGlwMyBpbnN0YWxsIHJlcXVlc3RzJykNCiAgICBwcmludCgnJXMgUmVxdWVzdHMgaGFzIGJlZW4gaW5zdGFsbGVkLicpDQogICAgb3Muc3lzdGVtKCdjbGVhcicpDQogICAgaW1wb3J0IHJlcXVlc3RzDQoNCg0KZGVmIG1haW4oKToNCiAgICBvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBwcmludChuYW1lLCJcbiIpDQogICAgaGVhZGVyID0geyJIb3N0IjogIm1lZ2FydW4uZGlhbG9nLmxrIiwNCiAgICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiBhdXRoLCAiWC1Vbml0eS1WZXJzaW9uIjogIjIwMTguMy4wZjIifQ0KICAgIGNvdW50PTAgICAgICAgICANCiAgICB1cmwgPSB1cmwxDQogICAgc3M9MA0KICAgIHRpbWUuc2xlZXAoOTApDQogICAgd2hpbGUgVHJ1ZToNCiAgICAgICAgc2l6ZSA9IDANCiAgICAgICAgcmVzID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpDQogICAgICAgIHJlczEgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcikNCiAgICAgICAgcmVzMiA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVyKQ0KICAgICAgICByZXMzPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcikNCiAgICAgICAgcmVzcCA9IHN0cihyZXMpDQogICAgICAgIGlmIHJlc3AgPT0gJzxSZXNwb25zZSBbMjA0XT4nOg0KICAgICAgICAgICAgcHJpbnQoYmFyKQ0KICAgICAgICAgICAgcHJpbnQoIlxuXDAzM1sxOzMyOzQwbSBbK10gTm8gRGF0YSAuLi4gWytdIikNCiAgICAgICAgICAgIHByaW50KCJcblwwMzNbMTszM20gIFJlY2V2ZWQgRGF0YSBNYXNzYWdlcyA9ICIsY291bnQpDQogICAgICAgICAgICBwcmludChiYXIpDQogICAgICAgIGVsaWYgcmVzcCA9PSAnPFJlc3BvbnNlIFsyMDBdPic6DQogICAgICAgICAgICBwcmludChiYXIpDQogICAgICAgICAgICBjb3VudCA9IGNvdW50ICsxDQogICAgICAgICAgICBwcmludCgiXG5cMDMzWzE7MzI7NDBtIFsrXSBZb3UgV29uIENoZWNrIEJhbGFuY2UgLi4uIFsrXSIpDQogICAgICAgICAgICBwcmludCgiXG5cMDMzWzE7MzNtICBSZWNldmVkIERhdGEgTWFzc2FnZXMgPSAiLGNvdW50KQ0KICAgICAgICAgICAgcHJpbnQoYmFyKQ0KICAgICAgICBlbHNlOg0KICAgICAgICAgICAgcHJpbnQoYmFyKQ0KICAgICAgICAgICAgcHJpbnQoIlxuXDAzM1sxOzMxOzQwbSBbK10gQ2hlY2sgQWdhaW4sIEkgdGhpbmsgWW91IGFyZSBCbG9ja2VkIFVzZXIuLi4gWytdIikNCiAgICAgICAgICAgIHByaW50KGJhcikNCg0KICAgICAgICBzcys9MQ0KICAgICAgICBwcmludCgiXDAzM1sxOzA7NDBtXG4iLHN0cihzcyksICJQbGVhc2UgV2FpdCBGb3IgTmV4dCByZXF1ZXN0IixlbmQ9IiIpDQogICAgICAgIGZvciBpIGluIHJhbmdlKDE4MCk6DQoNCiAgICAgICAgICAgIHByID0gaS8xODAqMTAwDQogICAgICAgICAgICBwcmludCgiXDAzM1sxOzM2OzQwbVxuPj4+IFsrXSIsc3RyKGludChwcikpICsiJSAiLGVuZD0iIikNCg0KICAgICAgICAgICAgdGltZS5zbGVlcCgwLjMpDQogICAgICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKCJcMDMzW0YiKQ0KDQogICAgb3Muc3lzdGVtKCdmaWdsZXQgRklOSVNIRUQnKQ0KICAgIGFnYWluKCkNCg0KDQpkZWYgYWdhaW4oKToNCiAgICBhZ2FpbiA9IGlucHV0KCdcMDMzWzE7MDs0MG1cbkRvIFlvdSB3YW50IHVzZSBhZ2FpbiAoeS9uKSAtICcpDQogICAgaWYgYWdhaW4gPT0gInkiIG9yIGFnYWluID09ICJZIjoNCiAgICAgICAgbWFpbigpDQogICAgZWxpZiBhZ2FpbiA9PSAibiIgb3IgYWdhaW4gPT0gIk4iOg0KICAgICAgICBxdWl0KCkNCiAgICBlbHNlOg0KICAgICAgICBwcmludCgnXDAzM1sxOzMxOzQwbUVudGVyIHZhbGlkIGxldHRlcicpDQogICAgICAgIGFnYWluKCkNCg0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgIG1haW4oKQ=="))
