import os
import base64
import zlib
import bz2

exec(base64.b64decode("aW1wb3J0IHRpbWUNCmltcG9ydCB1cmxsaWINCmltcG9ydCBzeXMNCmltcG9ydCBvcw0KDQpvcy5zeXN0ZW0oJ2NsZWFyJykNCm4gPSAoIldhaXQgZm9yIHN0YXJ0Li4uIikNCmJhciA9ICJcMDMzWzE7MzM7NDBtXG5fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19cbiINCmN1dCA9ICJcMDMzWzE7MzI7NDBtXG5cdFx0KyArICsgKyArICsgKyArICsgKyArICsgKyArICsgKyArICsiDQoNCm5hbWUgPSAiIiJcMDMzWzE7MzI7NDBtDQpfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KXDAzM1sxOzM2OzQwbSAgICAgIF9fICBfXyAgICAgICAgICAgICAgIF8gICAgICBfX19fICAgICAgICBfICAgXw0KXDAzM1sxOzM0OzQwbSAgICAgfCAgXC8gIHwgX19fICBfXyBfICAgLyBcICAgIHwgIF8gXCBfICAgX3wgXCB8IHwNClwwMzNbMTszNjs0MG0gICAgIHwgfFwvfCB8LyBfIFwvIF9gIHwgLyBPIFwgICB8IHxfKSB8IHwgfCB8ICBcfCB8DQpcMDMzWzE7MzQ7NDBtICAgICB8IHwgIHwgfCAgX18vIChffCB8LyBfX18gXCAgfCAgXyA8fCB8X3wgfCB8XCAgfA0KXDAzM1sxOzM2OzQwbSAgICAgfF98ICB8X3xcX19ffFxfXywgL18vICAgXF9cIHxffCBcX1xcX19fL3xffCBcX3wNClwwMzNbMTszNDs0MG0gICAgICAgICAgICAgICAgICB8X19fLw0KDQpcMDMzWzE7MzU7NDBtICAgICAgICAgICAgICBbK10gVG9vbCBCeSBFUlJPUiBLSUxMRVINClwwMzNbMTszMjs0MG1fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXw0KIiIiDQpwcmludChuYW1lLCAiIikNCg0KDQp0cnk6DQogICAgZiA9IG9wZW4oImF1dGgudHh0IiwgInIiKQ0KICAgIGF1dGggPSBmLnJlYWQoKQ0KICAgIGYuY2xvc2UNCmV4Y2VwdDoNCiAgICB3ciA9IHN0cihpbnB1dCgiXDAzM1sxOzA7NDBtUGFzdGUgWW91ciBBdXRoIGhlcmUgOi0gIikpDQogICAgZiA9IG9wZW4oImF1dGgudHh0IiwgInciKQ0KICAgIGYud3JpdGUod3IpDQogICAgZi5jbG9zZQ0KICAgIGYgPSBvcGVuKCJhdXRoLnR4dCIsICJyIikNCiAgICBhdXRoID0gZi5yZWFkKCkNCiAgICBmLmNsb3NlDQoNCnRyeToNCiAgICBmID0gb3BlbigidXJsLnR4dCIsICJyIikNCiAgICBmID0gb3BlbigidXJsLnR4dCIsICJyIikNCiAgICB1cmwxID0gZi5yZWFkKCkNCiAgICBmLmNsb3NlDQpleGNlcHQ6DQogICAgd3IgPSBzdHIoaW5wdXQoIlBhc3RlIFlvdXIgVVJMIGhlcmUgOi0gIikpDQogICAgZiA9IG9wZW4oInVybC50eHQiLCAidyIpDQogICAgZi53cml0ZSh3cikNCiAgICBmLmNsb3NlDQogICAgZiA9IG9wZW4oInVybC50eHQiLCAiciIpDQogICAgdXJsMSA9IGYucmVhZCgpDQogICAgZi5jbG9zZQ0KDQp0cnk6DQogICAgaW1wb3J0IHJlcXVlc3RzDQoNCg0KZXhjZXB0IEltcG9ydEVycm9yOg0KICAgIHByaW50KCclcyBSZXF1ZXN0cyBpc25cJ3QgaW5zdGFsbGVkLCBpbnN0YWxsaW5nIG5vdy4nKQ0KICAgIG9zLnN5c3RlbSgncGlwMyBpbnN0YWxsIHJlcXVlc3RzJykNCiAgICBwcmludCgnJXMgUmVxdWVzdHMgaGFzIGJlZW4gaW5zdGFsbGVkLicpDQogICAgb3Muc3lzdGVtKCdjbGVhcicpDQogICAgaW1wb3J0IHJlcXVlc3RzDQoNCg0KZGVmIG1haW4oKToNCglmb3IgcCBpbiByYW5nZShsZW4obikpOg0KCQl0aW1lLnNsZWVwKC4xKQ0KCQlzeXMuc3Rkb3V0LndyaXRlKG5bcF0pDQoJCXN5cy5zdGRvdXQuZmx1c2goKQ0KDQoJdGltZS5zbGVlcCg5MCkNCglvcy5zeXN0ZW0oImNsZWFyIikNCglwcmludChuYW1lLCJcbiIpDQoJaGVhZGVyID0geyJIb3N0IjogIm1lZ2FydW4uZGlhbG9nLmxrIiwNCiAgICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiBhdXRoLCAiWC1Vbml0eS1WZXJzaW9uIjogIjIwMTguMy4wZjIifQ0KCXVybCA9IHVybDENCglzcz0wDQoJdGQ9MA0KCXdoaWxlIFRydWU6DQoJCXNpemUgPSAwDQoJCXJlcyA9IHJlcXVlc3RzLmdldCh1cmwsIGhlYWRlcnM9aGVhZGVyKQ0KCQlyZXMyID0gcmVxdWVzdHMuZ2V0KHVybCwgaGVhZGVycz1oZWFkZXIpDQoJCXJlczMgPSByZXF1ZXN0cy5nZXQodXJsLCBoZWFkZXJzPWhlYWRlcikNCgkJcmVzcCA9IHN0cihyZXMpDQoJCWlmIHJlc3AgPT0gJzxSZXNwb25zZSBbMjA0XT4nOg0KCQkJcHJpbnQoYmFyKQ0KCQkJcHJpbnQoIlxuXDAzM1sxOzMxOzQwbSBbLV0gLi4uTm8gRGF0YSAuLi4gWy1dIikNCgkJCXByaW50KGJhcikNCgkJZWxpZiByZXNwID09ICc8UmVzcG9uc2UgWzIwMF0+JzoNCgkJCWlmIHJlcy50ZXh0ID09ICd7InR5cGUiOiJkYXRhIiwic2l6ZSI6MTB9JzoNCgkJCQl0ZCs9MTANCgkJCQlwcmludChiYXIpDQoJCQkJcHJpbnQoIlxuXDAzM1sxOzMyOzQwbSBbK10gQ29uZ3JhdHVsYXRpb25zISBZb3UgaGF2ZSBXT04gMTBNQiBmcm9tIERpYWxvZyBNZWdhIFJ1biBbK10iKQ0KCQkJCXByaW50KGN1dCkNCgkJCQlwcmludCgiXG5cMDMzWzE7Mzc7NDBtIFsqXSBUb3RhbCBmcm9tIHRoaXMgc2Vzc2lvbiDipJEgIitzdHIodGQpKyJNQiBbKl0iKQ0KCQkJCXByaW50KGJhcikNCgkJCWVsaWYgcmVzLnRleHQgPT0gJ3sidHlwZSI6ImRhdGEiLCJzaXplIjo1MH0nOg0KCQkJCXRkKz01MA0KCQkJCXByaW50KGJhcikNCgkJCQlwcmludCgiXG5cMDMzWzE7MzI7NDBtIFsrXSBDb25ncmF0dWxhdGlvbnMhIFlvdSBoYXZlIFdPTiA1ME1CIGZyb20gRGlhbG9nIE1lZ2EgUnVuIFsrXSIpDQoJCQkJcHJpbnQoY3V0KQ0KCQkJCXByaW50KCJcblwwMzNbMTszNzs0MG0gWypdIFRvdGFsIGZyb20gdGhpcyBzZXNzaW9uIOKkkSAiK3N0cih0ZCkrIk1CIFsqXSIpDQoJCQkJcHJpbnQoYmFyKQ0KCQllbHNlOg0KCQkJcHJpbnQoYmFyKQ0KCQkJcHJpbnQoIlxuXDAzM1sxOzMxOzQwbSBbI10gLi4uQ2hlY2sgQWdhaW4sIEkgdGhpbmsgWW91IGFyZSBCbG9ja2VkIFVzZXIuLi4gWyNdIikNCgkJCXByaW50KGJhcikNCg0KCQlzcys9MQ0KCQlwcmludCgiXDAzM1sxOzM1OzQwbVxuIixzdHIoc3MpLCAiUGxlYXNlIFdhaXQgRm9yIE5leHQgcmVxdWVzdCIsZW5kPSIiKQ0KCQlmb3IgaSBpbiByYW5nZSgxODApOg0KDQoJCQlwciA9IGkvMTgwKjEwMA0KCQkJcHJpbnQoIlwwMzNbMTszNjs0MG1cbj4+PiBbK10iLHN0cihpbnQocHIpKSArIiUgIixlbmQ9IiIpDQoNCgkJCXRpbWUuc2xlZXAoMC40KQ0KCQkJc3lzLnN0ZG91dC53cml0ZSgiXDAzM1tGIikNCg0KDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgbWFpbigpDQo="))
